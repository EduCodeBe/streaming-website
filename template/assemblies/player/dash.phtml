<script type="text/javascript" src="<?=h($assets)?>clapprio/dash-shaka-playback.min.js"></script>
<script type="text/javascript" src="<?=h($assets)?>clapprio/level-selector.min.js"></script>
<script type="text/javascript" src="<?=h($assets)?>clapprio/audio-selector.min.js"></script>

<div class="dashContainer">
	<div id="player"></div>
</div>

<!--
 this is an experimental hack, trying to protect the remaining page from
 interference with the new dash-player.
-->
<script type="text/javascript">
	var hasWebM = document.createElement('video').canPlayType('video/webm') != "";
	var player = new Clappr.Player({
			source: hasWebM ? '<?=h($room->getDashManifestUrl())?>' : '<?=h($room->getHLSPlaylistUrl())?>',
			width: "100%",
			plugins: [DashShakaPlayback, LevelSelector, AudioSelector],
			shakaConfiguration: {
				abr: {
					defaultBandwidthEstimate: 600000
				},
				streaming: {
					rebufferingGoal: 12,
					jumpLargeGaps: true
				}
			},
			levelSelectorConfig: {
				labels: {
					// HLS
					0: 'Slides',
					1: 'SD',
					2: 'HD',

					// DASH
					7: 'HD',
					8: 'SD',
					9: 'Slides',
					10: 'HD',
					11: 'SD',
					12: 'Slides',
					13: 'HD',
					14: 'SD',
					15: 'Slides',
				}
			},
			autoPlay: true,
			parentId: '#player'
		});
</script>


<style type="text/css">
#player > [data-player] {
	padding-bottom: 56.25%;
	height: auto !important;
}
body.room .player-wrap.tab-content {
	padding: 0;
}
</style>
